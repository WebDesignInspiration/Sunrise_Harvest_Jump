<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sunrise Harvest Jump</title>
  <style>
    body {
      margin: 0;
      background: #bfe6ff;
      overflow: hidden;
      font-family: "Arial Rounded MT Bold", sans-serif;
      text-align: center;
    }
    canvas { display:block; margin:0 auto; background:#bfe6ff; }
    #ui {
      position:absolute;
      top:10px; left:50%;
      transform:translateX(-50%);
      display:flex; gap:12px;
      z-index:10;
    }
    .pill {
      background:#ffffffcc;
      border:2px solid #00000014;
      border-radius:999px;
      padding:8px 14px;
      font-weight:bold;
      box-shadow:0 6px 14px rgba(0,0,0,.08);
    }
    .btn {
      cursor:pointer;
      transition:all .12s ease;
    }
    .btn:hover { transform:translateY(-1px); box-shadow:0 10px 20px rgba(0,0,0,.12);}
    .btn:active{ transform:translateY(0); box-shadow:0 6px 14px rgba(0,0,0,.08);}
  </style>
</head>
<body>
  <div id="ui">
    <div class="pill" id="score">Score: 0</div>
    <div class="pill btn" id="restart">Restart</div>
  </div>
  <canvas id="game" width="800" height="400"></canvas>

  <!-- Our main game script -->
  <script type="module">
    import { drawFox } from './fox.js';
    import { drawLog } from './obstacle.js';

    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const W = canvas.width, H = canvas.height;
    const GY = H-60; // ground Y

    let player = { x:50, y:GY-60, w:60, h:60, vy:0, onGround:true };
    let gravity = 0.8, jumpPower = -12;
    let obs = [];
    let frame = 0;
    let score = 0, running = true;

    function jump(){
      if(player.onGround){
        player.vy = jumpPower;
        player.onGround = false;
      }
    }

    document.addEventListener("keydown", e=>{
      if(e.code==="Space") jump();
    });
    document.getElementById("restart").onclick = ()=>reset();

    function reset(){
      player = { x:50, y:GY-60, w:60, h:60, vy:0, onGround:true };
      obs = [];
      score = 0; frame = 0;
      running = true;
      document.getElementById("score").innerText = "Score: 0";
    }

    function update(){
      if(!running) return;

      frame++;
      player.vy += gravity;
      player.y += player.vy;
      if(player.y+player.h >= GY){
        player.y = GY-player.h;
        player.vy = 0;
        player.onGround = true;
      }

      // obstacles
      if(frame%90===0){
        obs.push({x:W, y:GY-40, w:40, h:40});
      }
      for(let o of obs){ o.x -= 6; }
      obs = obs.filter(o=>o.x+o.w>0);

      // collisions
      for(let o of obs){
        if(player.x < o.x+o.w && player.x+player.w > o.x &&
           player.y < o.y+o.h && player.y+player.h > o.y){
          running=false;
        }
      }

      // score
      if(frame%30===0 && running){
        score++;
        document.getElementById("score").innerText = "Score: "+score;
      }
    }

    function draw(){
      ctx.fillStyle = '#bfe6ff';
      ctx.fillRect(0,0,W,H);
      ctx.fillStyle = '#3aa655';
      ctx.fillRect(0,GY,W,H-GY);

      // fox
      drawFox(ctx, player.x, player.y, player.w, player.h, player.vy, player.onGround, GY);

      // logs
      for(const o of obs){
        drawLog(ctx, o.x, o.y, o.w, o.h);
      }
    }

    function loop(){
      update();
      draw();
      requestAnimationFrame(loop);
    }

    loop();
  </script>
</body>
</html>
